# üöÄ Guide de D√©ploiement Vercel - MyBudget+

## üìã Vue d'ensemble

MyBudget+ est d√©ploy√© en **2 projets s√©par√©s** sur Vercel :
1. **Backend (API)** - Express.js + MongoDB
2. **Frontend (React)** - Vite + React

---

## ‚úÖ Fichiers de configuration cr√©√©s

- `MyBudget+/apps/web/vercel.json` - Configuration frontend
- `MyBudget+/backend/vercel.json` - Configuration backend

---

## üéØ √âtapes de d√©ploiement

### üì¶ PARTIE 1 : Backend (API)

#### 1Ô∏è‚É£ Pr√©parer MongoDB Atlas

1. Allez sur [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
2. Cr√©ez un compte / Connectez-vous
3. Cr√©ez un **cluster gratuit** (M0)
4. **Database Access** ‚Üí Add New Database User
   - Username : `mybudget-admin`
   - Password : (g√©n√©rez un mot de passe fort)
   - Built-in Role : `Read and write to any database`
5. **Network Access** ‚Üí Add IP Address
   - Choisissez : `0.0.0.0/0` (Allow from anywhere)
   - Confirmez
6. **Connect** ‚Üí Drivers ‚Üí Node.js
   - Copiez la **connection string**
   - Format : `mongodb+srv://username:password@cluster.mongodb.net/mybudget`
   - ‚ö†Ô∏è Remplacez `<password>` par votre mot de passe

#### 2Ô∏è‚É£ D√©ployer le Backend sur Vercel

1. Allez sur [Vercel](https://vercel.com)
2. Cliquez sur **"New Project"**
3. Importez votre repository GitHub (ou uploadez le dossier)
4. **Configuration** :
   - **Project Name** : `mybudget-backend`
   - **Root Directory** : `MyBudget+/backend` ‚ö†Ô∏è IMPORTANT
   - **Framework Preset** : `Other`
   - **Build Command** : (laissez vide)
   - **Output Directory** : (laissez vide)
   - **Install Command** : `npm install`

#### 3Ô∏è‚É£ Variables d'environnement Backend

Dans **Settings** ‚Üí **Environment Variables**, ajoutez :

| Nom | Valeur | Description |
|-----|--------|-------------|
| `MONGODB_URI` | `mongodb+srv://...` | URI de connexion MongoDB Atlas |
| `JWT_SECRET` | G√©n√©rez une cl√© al√©atoire de 64 caract√®res | Cl√© pour les tokens JWT |
| `NODE_ENV` | `production` | Environnement de production |
| `FRONTEND_URL` | `https://votre-frontend.vercel.app` | URL du frontend (√† ajouter apr√®s √©tape 5) |
| `ADMIN_CREATION_CODE` | `MYBUDGET-ADMIN-2025` | Code pour cr√©er des admins |

**Variables optionnelles** (pour Google OAuth et emails) :
- `GOOGLE_CLIENT_ID`
- `GOOGLE_CLIENT_SECRET`
- `GOOGLE_CALLBACK_URL`
- `EMAIL_USER`
- `EMAIL_PASS`

#### 4Ô∏è‚É£ Notez l'URL du Backend

Une fois d√©ploy√©, notez l'URL de votre backend :
```
https://mybudget-backend-xxxx.vercel.app
```

---

### üé® PARTIE 2 : Frontend (React)

#### 5Ô∏è‚É£ D√©ployer le Frontend sur Vercel

1. Vercel ‚Üí **"New Project"**
2. Importez le m√™me repository (ou uploadez)
3. **Configuration** :
   - **Project Name** : `mybudget-frontend`
   - **Root Directory** : `MyBudget+/apps/web` ‚ö†Ô∏è IMPORTANT
   - **Framework Preset** : `Vite`
   - **Build Command** : `npm run build`
   - **Output Directory** : `dist`
   - **Install Command** : `npm install`

#### 6Ô∏è‚É£ Variables d'environnement Frontend

Dans **Settings** ‚Üí **Environment Variables**, ajoutez :

| Nom | Valeur | Description |
|-----|--------|-------------|
| `VITE_API_URL` | `https://votre-backend.vercel.app/api` | URL de l'API backend (de l'√©tape 4) |

‚ö†Ô∏è **Important** : Remplacez par l'URL r√©elle de votre backend !

#### 7Ô∏è‚É£ Red√©ployer le Frontend

Apr√®s avoir ajout√© la variable d'environnement :
1. **Deployments** ‚Üí Cliquez sur le dernier d√©ploiement
2. **...** ‚Üí **Redeploy**

#### 8Ô∏è‚É£ Mettre √† jour la variable FRONTEND_URL du Backend

Maintenant que vous avez l'URL du frontend :
1. Retournez au projet **Backend** sur Vercel
2. **Settings** ‚Üí **Environment Variables**
3. Modifiez `FRONTEND_URL` avec l'URL de votre frontend
4. **Deployments** ‚Üí **Redeploy**

---

## üîß POST-D√âPLOIEMENT

### 9Ô∏è‚É£ V√©rifier CORS (Backend)

Le fichier `MyBudget+/backend/src/index.js` doit d√©j√† contenir la configuration CORS correcte avec `process.env.FRONTEND_URL`.

Si vous avez plusieurs domaines frontend, v√©rifiez que tous sont dans la liste CORS.

### üîü Cr√©er le premier administrateur

**Option 1 : Via MongoDB Compass** (recommand√©)
1. T√©l√©chargez [MongoDB Compass](https://www.mongodb.com/products/compass)
2. Connectez-vous avec votre URI MongoDB Atlas
3. Acc√©dez √† la collection `users`
4. Trouvez votre utilisateur
5. Modifiez le champ `role` : `"user"` ‚Üí `"admin"`
6. Sauvegardez

**Option 2 : Via l'interface admin**
1. Allez sur `https://votre-frontend.vercel.app/admin/signup`
2. Remplissez le formulaire
3. **Code d'activation** : `MYBUDGET-ADMIN-2025`
4. ‚ö†Ô∏è Cette page n√©cessite d'√™tre d√©j√† connect√© en tant qu'admin

---

## ‚úÖ Tests Post-D√©ploiement

### Testez les fonctionnalit√©s suivantes :

- [ ] **Inscription utilisateur** (`/signup`)
- [ ] **Connexion utilisateur** (`/login`)
- [ ] **Cr√©ation d'un budget**
- [ ] **Ajout d'une transaction**
- [ ] **Connexion admin** (`/admin/login`)
- [ ] **Dashboard admin** (`/admin`)
- [ ] **Mode sombre**
- [ ] **Responsive mobile**

---

## üêõ D√©pannage

### Erreur CORS
**Sympt√¥me** : `Access-Control-Allow-Origin error`
**Solution** : V√©rifiez que `FRONTEND_URL` est correctement configur√© dans le backend

### Erreur 404 sur routes frontend
**Sympt√¥me** : Rafra√Æchir la page donne une erreur 404
**Solution** : V√©rifiez que `vercel.json` du frontend contient les rewrites

### Erreur MongoDB connexion
**Sympt√¥me** : `MongoServerError: Authentication failed`
**Solution** : 
- V√©rifiez `MONGODB_URI` dans les variables d'environnement
- V√©rifiez que le mot de passe est correct (sans caract√®res sp√©ciaux non encod√©s)
- V√©rifiez Network Access sur MongoDB Atlas (0.0.0.0/0)

### Variables d'environnement non prises en compte
**Sympt√¥me** : Les modifications ne sont pas appliqu√©es
**Solution** : Apr√®s chaque modification de variable, red√©ployez le projet

---

## üìù Checklist finale

- [ ] Backend d√©ploy√© sur Vercel
- [ ] MongoDB Atlas configur√© et accessible
- [ ] Toutes les variables d'environnement backend ajout√©es
- [ ] Frontend d√©ploy√© sur Vercel
- [ ] Variable `VITE_API_URL` configur√©e
- [ ] Variable `FRONTEND_URL` du backend mise √† jour
- [ ] Premier admin cr√©√©
- [ ] Tests fonctionnels r√©ussis

---

## üéâ F√©licitations !

Votre application MyBudget+ est maintenant d√©ploy√©e et accessible en ligne !

**URLs de production :**
- Frontend : `https://mybudget-frontend-xxxx.vercel.app`
- Backend API : `https://mybudget-backend-xxxx.vercel.app/api`

---

## üìû Support

Pour toute question ou probl√®me :
1. V√©rifiez les logs dans Vercel Dashboard
2. V√©rifiez la console du navigateur (F12)
3. Consultez la documentation Vercel

