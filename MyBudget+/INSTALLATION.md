# üì¶ Guide d'installation - MyBudget+

## Installation rapide (D√©veloppement)

### 1Ô∏è‚É£ Pr√©requis

Installez les logiciels suivants :
- **Node.js** 18.x ou sup√©rieur : https://nodejs.org/
- **MongoDB** 6.x ou sup√©rieur : https://www.mongodb.com/try/download/community
- **Git** : https://git-scm.com/downloads

### 2Ô∏è‚É£ Installation

```bash
# 1. Cloner le repository
git clone <votre-repo>
cd MyBudget+

# 2. Installer les d√©pendances du backend
cd backend
npm install

# 3. Installer les d√©pendances du frontend
cd ../apps/web
npm install

# 4. Revenir √† la racine
cd ../..
```

### 3Ô∏è‚É£ Configuration

#### Backend

```bash
cd backend

# Copier le fichier d'exemple
cp .env.example .env

# √âditer le fichier .env
# Sur Windows : notepad .env
# Sur Mac/Linux : nano .env
```

**Modifiez ces valeurs dans `.env` :**
```env
# G√©n√©rez des secrets forts avec : node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=<g√©n√©rez un secret fort ici>
SESSION_SECRET=<g√©n√©rez un autre secret fort ici>

# Si vous utilisez Gmail pour les emails de reset
SMTP_USER=votre.email@gmail.com
SMTP_PASS=votre_mot_de_passe_application_gmail
```

> **Note** : Pour Gmail, cr√©ez un "mot de passe d'application" depuis https://myaccount.google.com/apppasswords

#### Frontend Web

```bash
cd apps/web

# Copier le fichier d'exemple
cp .env.example .env

# Le contenu par d√©faut est correct pour le d√©veloppement
```

### 4Ô∏è‚É£ G√©n√©rer des secrets forts

**G√©n√©rez vos secrets** avec cette commande Node.js :

```bash
# Ouvrez un terminal Node
node

# Dans le REPL Node, ex√©cutez :
require('crypto').randomBytes(32).toString('hex')

# R√©p√©tez pour avoir 2 secrets diff√©rents
# Copiez-collez ces valeurs dans votre .env
```

### 5Ô∏è‚É£ D√©marrer MongoDB

#### Option A : MongoDB install√© localement

```bash
# D√©marrer MongoDB
mongod

# Dans un autre terminal, v√©rifier la connexion
mongo
```

#### Option B : Docker

```bash
# Depuis la racine du projet
docker-compose up -d mongo

# V√©rifier que MongoDB fonctionne
docker ps
```

### 6Ô∏è‚É£ Lancer l'application

**Terminal 1 - Backend :**
```bash
cd backend
npm run dev
```

Vous devriez voir :
```
‚úÖ Routes configur√©es:
   - /api/reports/stats
   - /api/reports/categories
   ...
Server running on port 3001
```

**Terminal 2 - Frontend :**
```bash
cd apps/web
npm run dev
```

Vous devriez voir :
```
  VITE v7.1.2  ready in 500 ms

  ‚ûú  Local:   http://localhost:5173/
  ‚ûú  Network: use --host to expose
```

### 7Ô∏è‚É£ Acc√©der √† l'application

Ouvrez votre navigateur :
- **Frontend** : http://localhost:5173
- **API Backend** : http://localhost:3001/api/health

## ‚ö†Ô∏è Probl√®mes courants

### MongoDB ne d√©marre pas

**Erreur** : `Error: connect ECONNREFUSED 127.0.0.1:27017`

**Solutions** :
1. V√©rifiez que MongoDB est install√© : `mongod --version`
2. D√©marrez MongoDB : `mongod` (ou `brew services start mongodb-community` sur Mac)
3. V√©rifiez le port : MongoDB doit √©couter sur 27017
4. Changez l'URL dans `.env` si n√©cessaire

### Variables d'environnement manquantes

**Erreur** : `‚ùå JWT_SECRET is not defined in environment variables`

**Solution** :
1. V√©rifiez que le fichier `.env` existe dans `backend/`
2. V√©rifiez qu'il contient toutes les variables requises
3. Red√©marrez le serveur backend

### Port d√©j√† utilis√©

**Erreur** : `Error: listen EADDRINUSE: address already in use :::3001`

**Solutions** :
```bash
# Windows
netstat -ano | findstr :3001
taskkill /PID <PID> /F

# Mac/Linux
lsof -ti:3001 | xargs kill -9

# Ou changez le port dans .env
PORT=3002
```

### CORS Errors

**Erreur** : `Access to fetch at 'http://localhost:3001/api/...' has been blocked by CORS`

**Solutions** :
1. V√©rifiez que `FRONTEND_URL` dans `.env` backend est correct
2. V√©rifiez que le backend est d√©marr√©
3. Videz le cache du navigateur

### √âchec de connexion √† l'API

**Erreur** : `Failed to fetch` ou `Network Error`

**Solutions** :
1. V√©rifiez que le backend est d√©marr√©
2. V√©rifiez que `VITE_API_URL` dans `apps/web/.env` est correct
3. Testez l'API directement : http://localhost:3001/api/health

## üê≥ Installation avec Docker (Recommand√© pour production)

### 1. Pr√©requis
- Docker : https://docs.docker.com/get-docker/
- Docker Compose : https://docs.docker.com/compose/install/

### 2. Configuration

```bash
# Cr√©ez un fichier .env √† la racine
cat > .env << EOF
JWT_SECRET=$(node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
SESSION_SECRET=$(node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
EOF

# V√©rifiez le contenu
cat .env
```

### 3. D√©marrage

```bash
# Construire et d√©marrer tous les services
docker-compose up -d

# V√©rifier les logs
docker-compose logs -f

# V√©rifier le statut
docker-compose ps
```

### 4. Arr√™t

```bash
# Arr√™ter les services
docker-compose down

# Supprimer aussi les volumes (‚ö†Ô∏è supprime les donn√©es)
docker-compose down -v
```

## üì± Installation Mobile (Optionnel)

```bash
cd apps/mobile

# Installer les d√©pendances
npm install

# Installer Expo CLI globalement
npm install -g expo-cli

# D√©marrer le serveur de d√©veloppement
npm start

# Scanner le QR code avec Expo Go (iOS/Android)
```

## üîß D√©pannage avanc√©

### R√©installer toutes les d√©pendances

```bash
# Backend
cd backend
rm -rf node_modules package-lock.json
npm install

# Frontend
cd ../apps/web
rm -rf node_modules package-lock.json
npm install
```

### R√©initialiser la base de donn√©es

```bash
# Avec MongoDB local
mongo
> use mybudget
> db.dropDatabase()

# Avec Docker
docker-compose down -v
docker-compose up -d mongo
```

### Logs de debug

```bash
# Backend avec logs d√©taill√©s
cd backend
DEBUG=* npm run dev

# V√©rifier les variables d'environnement
node -e "require('dotenv').config(); console.log(process.env)"
```

## üìö Prochaines √©tapes

Une fois l'installation termin√©e :
1. Consultez le [README.md](./README.md) pour les fonctionnalit√©s
2. Lisez [SECURITY.md](./SECURITY.md) pour la s√©curit√©
3. Explorez la documentation dans `/docs`

## üí¨ Besoin d'aide ?

- Ouvrez une issue sur GitHub
- Consultez la FAQ
- Contactez le support

---

Bon d√©veloppement ! üöÄ

