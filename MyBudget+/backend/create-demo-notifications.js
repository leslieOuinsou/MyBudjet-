import mongoose from 'mongoose';
import dotenv from 'dotenv';
import {
  createBudgetAlertNotification,
  createBudgetExceededNotification,
  createTransactionNotification,
  createGoalAchievedNotification,
  createSystemNotification,
  createWelcomeNotification,
  createWeeklySummaryNotification
} from './src/utils/notificationGenerator.js';

// Charger les variables d'environnement
dotenv.config();

const createDemoNotifications = async () => {
  try {
    console.log('üîó Connexion √† MongoDB...');
    await mongoose.connect(process.env.MONGODB_URI);
    console.log('‚úÖ Connect√© √† MongoDB\n');

    // IMPORTANT : Remplacez cet ID par votre vrai ID utilisateur
    const userId = '68ed24faf29407bc07a57525'; // VOTRE USER ID

    console.log('üìù Cr√©ation de notifications vari√©es...\n');

    // 1. Notification de bienvenue
    await createWelcomeNotification(userId, 'Leslie');
    
    // 2. Alerte budg√©taire (80%)
    await createBudgetAlertNotification(userId, 'Alimentation', 80, 50);
    
    // 3. Alerte budg√©taire (90%)
    await createBudgetAlertNotification(userId, 'Loisirs', 90, 20);
    
    // 4. Budget d√©pass√©
    await createBudgetExceededNotification(userId, 'Restaurant', 25);
    
    // 5. Nouvelle transaction
    await createTransactionNotification(userId, 45.50, 'Courses', 'Supermarch√© Carrefour');
    
    // 6. Nouvelle transaction
    await createTransactionNotification(userId, 12, 'Transport', 'Ticket de m√©tro');
    
    // 7. Objectif atteint
    await createGoalAchievedNotification(userId, 'Vacances d\'√©t√©', 500);
    
    // 8. R√©sum√© hebdomadaire
    await createWeeklySummaryNotification(userId, 234, 1500, 84);
    
    // 9. Notification syst√®me
    await createSystemNotification(
      userId, 
      'Nouvelle fonctionnalit√© disponible', 
      'Le mode sombre est maintenant disponible dans les param√®tres !'
    );

    console.log('\n‚úÖ 9 notifications cr√©√©es avec succ√®s !');
    console.log('üîî Rechargez votre application pour voir le badge rouge avec le chiffre "9"');
    
    await mongoose.connection.close();
    console.log('\nüîå D√©connexion de MongoDB');
    process.exit(0);
  } catch (error) {
    console.error('‚ùå Erreur:', error);
    process.exit(1);
  }
};

createDemoNotifications();

